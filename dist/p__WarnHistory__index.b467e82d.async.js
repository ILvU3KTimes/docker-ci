(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[52],{"/vaZ":function(e,t,n){"use strict";n.r(t);n("5NDa");var a,r,o,i=n("5rEg"),c=(n("/zsF"),n("PArb")),l=(n("bP8k"),n("gFTJ")),d=(n("sPJy"),n("bE4q")),s=(n("+L6B"),n("2/Rp")),u=(n("nRaC"),n("5RzL")),m=(n("14J3"),n("BMrR")),f=(n("jCWc"),n("kPKH")),p=n("jehZ"),h=n.n(p),v=(n("miYZ"),n("tsqr")),y=n("1l/V"),g=n.n(y),b=(n("2qtc"),n("kLXV")),E=n("p0pE"),w=n.n(E),T=n("Y/ft"),I=n.n(T),O=n("2Taf"),k=n.n(O),S=n("vZ4D"),j=n.n(S),C=n("l4Ni"),Y=n.n(C),x=n("ujKo"),H=n.n(x),D=n("MhPg"),M=n.n(D),R=(n("iQDF"),n("+eQT")),F=(n("OaEy"),n("2fM7")),N=(n("y8nQ"),n("Vl3Y")),V=n("q1tI"),P=n.n(V),z=n("3a4m"),L=n.n(z),A=n("MuoO"),B=n("wd/R"),G=n.n(B),_=n("Py4S"),q=n.n(_),J=n("jwXe"),Z=n("+n12"),K=n("i8+L"),Q=n("YbjC"),X=n("ZFw/"),W=n.n(X),U=n("bfXr"),$=n("T+dw"),ee=n("Qyje"),te=n("qFW+"),ne=n("dSGz"),ae=n.n(ne),re=n("34ay"),oe=n("wHMd");function ie(){var e,t,n="function"==typeof Symbol?Symbol:{},a=n.iterator||"@@iterator",r=n.toStringTag||"@@toStringTag";function o(n,a,r,o){var l=a&&a.prototype instanceof c?a:c,d=Object.create(l.prototype);return ce(d,"_invoke",function(n,a,r){var o,c,l,d=0,s=r||[],u=!1,m={p:0,n:0,v:e,a:f,f:f.bind(e,4),d:function(t,n){return o=t,c=0,l=e,m.n=n,i}};function f(n,a){for(c=n,l=a,t=0;!u&&d&&!r&&t<s.length;t++){var r,o=s[t],f=m.p,p=o[2];n>3?(r=p===a)&&(l=o[(c=o[4])?5:(c=3,3)],o[4]=o[5]=e):o[0]<=f&&((r=n<2&&f<o[1])?(c=0,m.v=a,m.n=o[1]):f<p&&(r=n<3||o[0]>a||a>p)&&(o[4]=n,o[5]=a,m.n=p,c=0))}if(r||n>1)return i;throw u=!0,a}return function(r,s,p){if(d>1)throw TypeError("Generator is already running");for(u&&1===s&&f(s,p),c=s,l=p;(t=c<2?e:l)||!u;){o||(c?c<3?(c>1&&(m.n=-1),f(c,l)):m.n=l:m.v=l);try{if(d=2,o){if(c||(r="next"),t=o[r]){if(!(t=t.call(o,l)))throw TypeError("iterator result is not an object");if(!t.done)return t;l=t.value,c<2&&(c=0)}else 1===c&&(t=o.return)&&t.call(o),c<2&&(l=TypeError("The iterator does not provide a '"+r+"' method"),c=1);o=e}else if((t=(u=m.n<0)?l:n.call(a,m))!==i)break}catch(t){o=e,c=1,l=t}finally{d=1}}return{value:t,done:u}}}(n,r,o),!0),d}var i={};function c(){}function l(){}function d(){}t=Object.getPrototypeOf;var s=[][a]?t(t([][a]())):(ce(t={},a,function(){return this}),t),u=d.prototype=c.prototype=Object.create(s);function m(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,d):(e.__proto__=d,ce(e,r,"GeneratorFunction")),e.prototype=Object.create(u),e}return l.prototype=d,ce(u,"constructor",d),ce(d,"constructor",l),l.displayName="GeneratorFunction",ce(d,r,"GeneratorFunction"),ce(u),ce(u,r,"Generator"),ce(u,a,function(){return this}),ce(u,"toString",function(){return"[object Generator]"}),(ie=function(){return{w:o,m:m}})()}function ce(e,t,n,a){var r=Object.defineProperty;try{r({},"",{})}catch(e){r=0}ce=function(e,t,n,a){function o(t,n){ce(e,t,function(e){return this._invoke(t,n,e)})}t?r?r(e,t,{value:n,enumerable:!a,configurable:!a,writable:!a}):e[t]=n:(o("next",0),o("throw",1),o("return",2))},ce(e,t,n,a)}function le(e,t,n){return t=H()(t),Y()(e,de()?Reflect.construct(t,n||[],H()(e).constructor):t.apply(e,n))}function de(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(de=function(){return!!e})()}var se=N["a"].Item,ue=F["a"].Option,me=(F["a"].OptGroup,R["a"].RangePicker),fe=(a=N["a"].create(),r=Object(A["connect"])(function(e){var t=e.warning,n=e.eventMonitor,a=e.loading;return{warning:t,eventMonitor:n,loading:a.models.warning}}),a(o=r(o=function(e){function t(e){var n;return k()(this,t),n=le(this,t,[e]),n.onHomeClick=function(){L.a.push("/monitor/eventMonitor")},n.handleSearch=function(e){var t=n.props.dispatch;if(e){var a=e.occurrenceTime,r=e.status,o=(e.category,e.deviceIds),i=e.alertType,c=I()(e,["occurrenceTime","status","category","deviceIds","alertType"]);t(Object(te["e"])(w()({startTime:a?Q["a"].format(a[0],"YYYY-MM-DD HH:mm:ss"):"",endTime:a?Q["a"].format(a[1],"YYYY-MM-DD HH:mm:ss"):"",status:"-99"===r?"":r,deviceIds:o?o.join(","):"",alertType:"-99"===i?"":i},c)))}else{var l=Object(re["g"])(),d=l.current,s=l.size,u=l.formValues;console.log(u),t(Object(te["e"])({current:d,size:s,startTime:u.occurrenceTime&&u.occurrenceTime[0]?Q["a"].format(G()(u.occurrenceTime[0]),"YYYY-MM-DD HH:mm:ss"):"",endTime:u.occurrenceTime&&u.occurrenceTime[1]?Q["a"].format(G()(u.occurrenceTime[1]),"YYYY-MM-DD HH:mm:ss"):"",status:"-99"===u.status?"":u.status,deviceIds:u.deviceIds?u.deviceIds.join(","):"",behaviorAction:u.behaviorAction?u.behaviorAction:""}))}},n.handleEdit=function(e){var t=n.props,a=t.dispatch,r=t.form.getFieldValue,o=n.state.selectedRows,i=void 0===o?[]:o,c=n;b["a"].confirm({title:0===e?"\u662f\u5426\u786e\u8ba4\u9009\u4e2d\u4e8b\u4ef6\uff1f":"\u662f\u5426\u786e\u5b9a\u9009\u4e2d\u4e8b\u4ef6\u4e3a\u3010\u8bef\u62a5\u3011\uff1f",content:"\u63d0\u4ea4\u6210\u529f\u540e\u72b6\u6001\u4e0d\u80fd\u66f4\u6539",okText:"\u786e\u5b9a",okType:"danger",cancelText:"\u53d6\u6d88",onOk:function(){var t=g()(ie().m(function t(){var n;return ie().w(function(t){while(1)switch(t.n){case 0:n=i.map(function(e){return e.eventId}),a({type:"".concat(te["f"],"/batchLogEvent"),payload:{eventIds:n,processRemark:r("processRemark"),status:e}}).then(function(){c.gridChild.clearSelectedKey(),c.setState({selectedRows:[]}),c.handleCancel(),c.handleSearch()});case 1:return t.a(2)}},t)}));function n(){return t.apply(this,arguments)}return n}(),onCancel:function(){}})},n.onSelectRow=function(e){n.setState({selectedRows:e})},n.getDeviceListOptions=function(){var e=n.props.warning,t=e.deviceList,a=void 0===t?[]:t;return a.map(function(e){return P.a.createElement(ue,{key:e.deviceId,value:e.deviceId},e.deviceName)})},n.onBacthClick=function(){var e=n.state.selectedRows;e.length<=0?v["a"].warning("\u8bf7\u9009\u62e9\u9700\u8981\u5904\u7406\u7684\u4e8b\u4ef6"):n.setState({batchVisible:!0})},n.renderSearchForm=function(e){var t=n.props,a=t.form,r=t.warning,o=r.handleStatus,i=void 0===o?[]:o,c=r.eventTypes,l=void 0===c?[]:c,d=r.areaDeviceTree,p=void 0===d?[]:d,v=a.getFieldDecorator,y={labelCol:{span:6},wrapperCol:{span:18}};return P.a.createElement(P.a.Fragment,null,P.a.createElement(m["a"],{gutter:[24,24]},P.a.createElement(f["a"],{span:8},P.a.createElement(se,h()({label:"\u53d1\u751f\u65f6\u95f4"},y),v("occurrenceTime",{initialValue:[G()().add(-1,"days").startOf("day"),G()().endOf("day")]})(P.a.createElement(me,{showTime:{format:"HH:mm:ss"},format:"YYYY-MM-DD HH:mm:ss",placeholder:["\u5f00\u59cb\u65f6\u95f4","\u7ed3\u675f\u65f6\u95f4"],allowClear:!1,disabledDate:function(e){return e&&e>G()().endOf("day")},ranges:{"\u8fd17\u5929":[G()().add(-7,"days").startOf("day"),G()().endOf("day")],"\u8fd130\u5929":[G()().add(-30,"days").startOf("day"),G()().endOf("day")],"\u8fd190\u5929":[G()().add(-90,"days").startOf("day"),G()().endOf("day")]}})))),P.a.createElement(f["a"],{span:8},P.a.createElement(se,h()({label:"\u72b6\u6001"},y),v("status",{initialValue:"-99"})(P.a.createElement(F["a"],{placeholder:"\u8bf7\u9009\u62e9\u72b6\u6001"},Object(Z["j"])(i,!0,"-99"))))),P.a.createElement(f["a"],{span:8},P.a.createElement(se,h()({label:"\u4e8b\u4ef6\u7c7b\u578b"},y),v("behaviorAction",{})(P.a.createElement(F["a"],{placeholder:"\u8bf7\u9009\u62e9\u4e8b\u4ef6\u7c7b\u578b",allowClear:!0},l.map(function(e){return P.a.createElement(ue,{value:e.abilityCode},e.abilityName)})))))),P.a.createElement(m["a"],{gutter:[24,0]},P.a.createElement(f["a"],{span:8},P.a.createElement(se,h()({label:"\u8bbe\u5907\u540d\u79f0"},y),v("deviceIds")(P.a.createElement(u["a"],{style:{width:"100%"},dropdownStyle:{maxHeight:400,overflow:"auto"},placeholder:"\u8bf7\u9009\u62e9\u6444\u50cf\u5934",allowClear:!0,multiple:!0,treeDefaultExpandAll:!0},n.renderTreeNodes(p))))),P.a.createElement(f["a"],{span:16},P.a.createElement("div",{style:{float:"right"}},P.a.createElement(s["a"],{type:"primary",htmlType:"submit"},"\u67e5\u8be2"),P.a.createElement(s["a"],{style:{marginLeft:8},onClick:e},"\u91cd\u7f6e")))))},n.renderTreeNodes=function(e){return e.map(function(e){return e.children?P.a.createElement(u["a"].TreeNode,{key:e.id,value:e.id,title:e.nodeName,disabled:"device"!==e.nodeType,dataRef:e,checkable:"device"===e.nodeType,selectable:"device"===e.nodeType},n.renderTreeNodes(e.children)):P.a.createElement(u["a"].TreeNode,e)})},n.onExport=function(){var e=n.props.form,t=e.getFieldsValue(),a=t.occurrenceTime,r=t.status,o=(t.category,t.deviceIds),i=t.alertType,c=I()(t,["occurrenceTime","status","category","deviceIds","alertType"]),l=w()({startTime:a?Q["a"].format(a[0],"YYYY-MM-DD HH:mm:ss"):"",endTime:a?Q["a"].format(a[1],"YYYY-MM-DD HH:mm:ss"):"",status:"-99"===r?"":r,deviceIds:o?o.join(","):"",alertType:"-99"===i?"":i},c);Object(Z["b"])("".concat($["proxyHeader"],"/aiVideo/behaviorLog/export?").concat(Object(ee["stringify"])(l)),"\u5386\u53f2\u4e8b\u4ef6.xlsx")},n.handleCancel=function(){n.setState({visible:!1,batchVisible:!1})},n.renderActionButton=function(e,t){return P.a.createElement(V["Fragment"],{key:"detail"},P.a.createElement("a",{onClick:function(){var e=n.props.dispatch,a=t[0];e({type:"eventMonitor/getBehaviorLog",payload:{eventId:a.eventId}}).then(function(){n.setState({visible:!0,detail:a})})}},!0===t[0].disabledCheckbox?"\u8be6\u60c5":"\u5904\u7406"))},n.state={visible:!1,batchVisible:!1,detail:{},selectedRows:[],fetchStream:!0},n.minioUrl=$["imgHeader"],n.gridChild=null,n.footer=[P.a.createElement(s["a"],{size:"large",key:"edit",onClick:function(){return n.handleEdit(0)},style:{backgroundColor:"green",color:"#fff"}},"\u786e\u8ba4"),P.a.createElement(s["a"],{size:"large",key:"misjudgment",onClick:function(){return n.handleEdit(1)},style:{backgroundColor:"orange",color:"#fff"}},"\u8bef\u62a5")],n}return M()(t,e),j()(t,[{key:"componentDidMount",value:function(){var e=this.props.dispatch;e(Object(te["d"])(K["b"])),e(Object(te["a"])()),e(Object(te["b"])()),e(Object(te["c"])())}},{key:"render",value:function(){var e=this,t=this.props,n=t.form,a=t.loading,r=t.warning,o=r.data,s=void 0===o?{}:o,u=r.handleStatus,m=void 0===u?[]:u,f=this.state,p=f.visible,v=f.detail,y=void 0===v?{}:v,g=f.batchVisible,E=f.selectedRows,w=f.fetchStream,T=[{title:"\u4e8b\u4ef6\u7f16\u53f7",dataIndex:"eventId",align:"center",render:function(e){return e||"-"}},{title:"\u6444\u50cf\u5934",dataIndex:"deviceName",align:"center",render:function(e){return e||"-"}},{title:"\u6240\u5c5e\u533a\u57df",dataIndex:"regionName",align:"center",render:function(e){return e||"-"}},{title:"\u4e8b\u4ef6\u7c7b\u578b",dataIndex:"behaviorAction",align:"center",render:function(e){return e||"-"}},{title:"\u8bc6\u522b\u7ed3\u679c",dataIndex:"recognizeResult",align:"center",render:function(e){return e||"-"}},{title:"\u4e8b\u4ef6\u56fe\u7247",dataIndex:"imgInfo",align:"center",render:function(e,t){return e?P.a.createElement(q.a,{controller:{close:!0,zoom:!1,download:!0,rotate:!0,flip:!1,pagination:!1},style:{width:"100px",height:"auto"},src:e}):"-"}},{title:"\u72b6\u6001",dataIndex:"status",align:"center",render:function(e){return Object(Z["e"])(m,K["b"],e.toString())}},{title:"\u53d1\u751f\u65f6\u95f4",dataIndex:"eventDate",align:"center"},{title:"\u5904\u7406\u4eba",dataIndex:"updateByName",align:"center",render:function(e){return e||"-"}},{title:"\u5904\u7406\u65f6\u95f4",dataIndex:"updateTime",align:"center",render:function(e){return e||"-"}},{title:"\u5904\u7406\u5907\u6ce8",dataIndex:"processRemark",align:"center",render:function(e){return e||"-"}}];return P.a.createElement(W.a,{title:window.monitorTitle},P.a.createElement("div",{className:ae.a.warnHistory},P.a.createElement("div",{className:ae.a.header},P.a.createElement("span",null,window.monitorTitle),P.a.createElement(U["a"],{className:ae.a.langSelect,trigger:["click"]})),P.a.createElement(d["a"],null,P.a.createElement(d["a"].Item,{onClick:this.onHomeClick},P.a.createElement("a",null,"\u4e8b\u4ef6\u76d1\u63a7")),P.a.createElement(d["a"].Item,null,"\u5386\u53f2\u4e8b\u4ef6")),P.a.createElement(J["a"],{form:n,onSearch:this.handleSearch,renderSearchForm:this.renderSearchForm,renderActionButton:this.renderActionButton,data:s,onRef:function(t){e.gridChild=t},size:8,rowSelectionProp:!0,loading:a,columns:T,pkField:"eventId",rowKey:"eventId",onSelectRow:this.onSelectRow}),y?P.a.createElement(oe["a"],{pageId:"warnHistory",visible:p,handleCancel:this.handleCancel,handleSearch:this.handleSearch,logInfo:y,fetchStream:w}):null,P.a.createElement(b["a"],{title:"\u5386\u53f2\u4e8b\u4ef6\u6279\u5904\u7406",visible:g,footer:this.footer,onCancel:this.handleCancel,destroyOnClose:!0,width:"60%"},E.map(function(e){return P.a.createElement(l["a"],{column:5,size:"default"},P.a.createElement(l["a"].Item,{label:"\u4e8b\u4ef6\u7f16\u53f7"},e.eventId||"-"),P.a.createElement(l["a"].Item,{label:"\u6444\u50cf\u5934"},e.deviceName||"-"),P.a.createElement(l["a"].Item,{label:"\u4e8b\u4ef6\u7c7b\u578b"},e.behaviorAction||"-"),P.a.createElement(l["a"].Item,{label:"\u72b6\u6001"},"".concat(Object(Z["e"])(m,K["b"],e.status))||"-"),P.a.createElement(l["a"].Item,{label:"\u53d1\u751f\u65f6\u95f4"},e.eventDate||"-"))}),P.a.createElement(c["a"],{dashed:!0}),P.a.createElement(N["a"],null,P.a.createElement(se,h()({label:"\u5904\u7406\u5907\u6ce8"},this.formItemLayout),n.getFieldDecorator("processRemark",{initialValue:""})(P.a.createElement(i["a"],{maxLength:32,placeholder:"\u8bf7\u8f93\u5165\u5904\u7406\u5907\u6ce8"})))))))}}])}(V["PureComponent"]))||o)||o);t["default"]=fe},dSGz:function(e,t,n){e.exports={warnHistory:"antd-pro-pages-warn-history-index-warnHistory",header:"antd-pro-pages-warn-history-index-header",langSelect:"antd-pro-pages-warn-history-index-langSelect"}}}]);