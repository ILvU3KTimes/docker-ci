(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([[30],{ALkd:function(e,t,a){e.exports={StreamPlay:"antd-pro-pages-stream-media-stream-play-StreamPlay",list:"antd-pro-pages-stream-media-stream-play-list",listHeader:"antd-pro-pages-stream-media-stream-play-listHeader",listItem:"antd-pro-pages-stream-media-stream-play-listItem",checkbox:"antd-pro-pages-stream-media-stream-play-checkbox",emptyCard:"antd-pro-pages-stream-media-stream-play-emptyCard",closeIcon:"antd-pro-pages-stream-media-stream-play-closeIcon",playerCard:"antd-pro-pages-stream-media-stream-play-playerCard"}},XVKO:function(e,t,a){"use strict";a.r(t);a("14J3");var n=a("BMrR"),l=(a("R9oj"),a("ECub")),r=(a("IzEo"),a("bx4M")),i=(a("Pwec"),a("CtXQ")),o=(a("jCWc"),a("kPKH")),c=(a("Mwp2"),a("VXEj")),s=(a("5Dmo"),a("3S7+")),d=(a("Awhp"),a("KrTs")),p=(a("sRBo"),a("kaz8")),u=a("2Taf"),m=a.n(u),h=a("vZ4D"),f=a.n(h),v=a("l4Ni"),y=a.n(v),g=a("ujKo"),E=a.n(g),C=a("MhPg"),S=a.n(C),b=(a("2qtc"),a("kLXV")),w=a("q1tI"),x=a.n(w),k=a("MuoO"),N=a("+n12"),I=a("OsNH"),T=a("CC8X"),A=a("jehZ"),M=a.n(A),P=a("eHn4"),D=a.n(P),L=a("Y/ft"),O=a.n(L),H=a("p0pE"),R=a.n(H),V=a("TSYQ"),j=a.n(V),B=a("mcBY"),W=a.n(B);function J(e,t,a){return t=E()(t),y()(e,X()?Reflect.construct(t,a||[],E()(e).constructor):t.apply(e,a))}function X(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(X=function(){return!!e})()}var K,U,Y=void 0!==document.body.style.webkitLineClamp,q={overflowWrap:"break-word",wordWrap:"break-word"},z=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"";return e.split("").reduce(function(e,t){var a=t.charCodeAt(0);return a>=0&&a<=128?e+1:e+2},0)},G=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",t=arguments.length>1?arguments[1]:void 0,a=0;return e.split("").reduce(function(e,n){var l=n.charCodeAt(0);return a+=l>=0&&l<=128?1:2,a<=t?e+n:e},"")},Q=function(e){var t=e.tooltip,a=e.placement,n=e.overlayStyle,l=e.title,r=e.children;if(t){var i=!0===t?{overlayStyle:n,title:l,placement:a}:R()({},t,{overlayStyle:n,title:l,placement:a});return x.a.createElement(s["a"],i,r)}return r},Z=function(e){var t=e.text,a=e.length,n=e.tooltip,l=e.placement,r=e.fullWidthRecognition,i=O()(e,["text","length","tooltip","placement","fullWidthRecognition"]);if("string"!==typeof t)throw new Error("Ellipsis children must be string.");var o=r?z(t):t.length;if(o<=a||a<0)return x.a.createElement("span",i,t);var c,s="...";c=a-s.length<=0?"":r?G(t,a):t.slice(0,a);var d=n?{}:R()({},i);return Q({tooltip:n,placement:l,overlayStyle:q,title:t,children:x.a.createElement("span",d,c,s)})},_=function(e){function t(){var e;m()(this,t);for(var a=arguments.length,n=new Array(a),l=0;l<a;l++)n[l]=arguments[l];return e=J(this,t,[].concat(n)),e.state={text:"",targetCount:0},e.computeLine=function(){var t=e.props.lines;if(t&&!Y){var a=e.shadowChildren.innerText||e.shadowChildren.textContent,n=parseInt(getComputedStyle(e.root).lineHeight,10),l=t*n;e.content.style.height="".concat(l,"px");var r=e.shadowChildren.offsetHeight,i=e.shadow.firstChild;if(r<=l)return void e.setState({text:a,targetCount:a.length});var o=a.length,c=Math.ceil(o/2),s=e.bisection(l,c,0,o,a,i);e.setState({text:a,targetCount:s})}},e.bisection=function(t,a,n,l,r,i){var o="...",c=a,s=l,d=n;i.innerHTML=r.substring(0,c)+o;var p=i.offsetHeight;return p<=t?(i.innerHTML=r.substring(0,c+1)+o,p=i.offsetHeight,p>t||c===d?c:(d=c,c=s-d===1?1+d:Math.floor((s-d)/2)+d,e.bisection(t,c,d,s,r,i))):c-1<0?c:(i.innerHTML=r.substring(0,c-1)+o,p=i.offsetHeight,p<=t?c-1:(s=c,c=Math.floor((s-d)/2)+d,e.bisection(t,c,d,s,r,i)))},e.handleRoot=function(t){e.root=t},e.handleContent=function(t){e.content=t},e.handleNode=function(t){e.node=t},e.handleShadow=function(t){e.shadow=t},e.handleShadowChildren=function(t){e.shadowChildren=t},e}return S()(t,e),f()(t,[{key:"componentDidMount",value:function(){this.node&&this.computeLine()}},{key:"componentDidUpdate",value:function(e){var t=this.props.lines;t!==e.lines&&this.computeLine()}},{key:"render",value:function(){var e=this.state,t=e.text,a=e.targetCount,n=this.props,l=n.children,r=n.lines,i=n.length,o=n.className,c=n.tooltip,s=n.placement,d=n.fullWidthRecognition,p=O()(n,["children","lines","length","className","tooltip","placement","fullWidthRecognition"]),u=j()(W.a.ellipsis,o,D()(D()({},W.a.lines,r&&!Y),W.a.lineClamp,r&&Y));if(!r&&!i)return x.a.createElement("span",M()({className:u},p),l);if(!r)return x.a.createElement(Z,M()({className:u,length:i,text:l||"",tooltip:c,fullWidthRecognition:d},p));var m="antd-pro-ellipsis-".concat("".concat((new Date).getTime()).concat(Math.floor(100*Math.random())));if(Y){var h="#".concat(m,"{-webkit-line-clamp:").concat(r,";-webkit-box-orient: vertical;}"),f=x.a.createElement("div",M()({id:m,className:u},p),x.a.createElement("style",null,h),l);return Q({tooltip:c,placement:s,overlayStyle:q,title:l,children:f})}var v=x.a.createElement("span",{ref:this.handleNode},a>0&&t.substring(0,a),a>0&&a<t.length&&"...");return x.a.createElement("div",M()({},p,{ref:this.handleRoot,className:u}),x.a.createElement("div",{ref:this.handleContent},Q({tooltip:c,overlayStyle:q,title:t,children:v}),x.a.createElement("div",{className:W.a.shadow,ref:this.handleShadowChildren},l),x.a.createElement("div",{className:W.a.shadow,ref:this.handleShadow},x.a.createElement("span",null,t))))}}])}(w["Component"]),F=a("2NJU"),$=a("ALkd"),ee=a.n($),te=a("GDzq");function ae(e,t,a){return t=E()(t),y()(e,ne()?Reflect.construct(t,a||[],E()(e).constructor):t.apply(e,a))}function ne(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch(e){}return(ne=function(){return!!e})()}var le=b["a"].confirm,re=(K=Object(k["connect"])(function(e){var t=e.streamPlay;return{streamPlay:t}}),K(U=function(e){function t(e){var a;return m()(this,t),a=ae(this,t,[e]),a.getDeviceList=function(){var e=a.props.dispatch,t=a.state,n=t.selectedValues,l=t.playArr;e(Object(F["a"])()).then(function(e){var t=a.filterOfflineDevice(e,n),r=a.filterOfflineDevice(e,l);a.setState({selectedValues:t,playArr:r})})},a.filterOfflineDevice=function(e,t){var n=e.filter(function(e){return!1===e.onlineStatus});return n.forEach(function(e){a.cancelSelected(t,e)}),t},a.selectDevice=function(e,t){var n=t.target.checked,l=a.state,r=l.playArr,i=l.selectedValues,o=a.boundary.maxPlayerNum;n?(r.length<o&&r.push(e),i.length<o&&i.push(e.deviceId)):(a.cancelSelected(r,e),a.cancelSelected(i,e)),a.setState({playArr:r,isChecked:n,selectedValues:i})},a.closePlayer=function(e){var t=a.state,n=t.playArr,l=t.selectedValues;le({title:"\u5173\u95ed\u786e\u8ba4",content:"\u786e\u5b9a\u5173\u95ed\u8be5\u64ad\u653e\u5668\u5417\uff1f",okText:"\u786e\u5b9a",okType:"danger",cancelText:"\u53d6\u6d88",onOk:function(){a.cancelSelected(n,e),a.cancelSelected(l,e),a.setState({playArr:n,selectedValues:l})}})},a.cancelSelected=function(e,t){var a=null;e.forEach(function(n){"string"!==typeof n&&"number"!==typeof n||n===t.deviceId&&(a=e.indexOf(n)),"object"===typeof n&&n.deviceId===t.deviceId&&(a=e.indexOf(n))}),(a||0===a)&&e.splice(a,1)},a.state={playArr:[],isChecked:!1,selectedValues:[]},a.boundary={maxPlayerNum:4},a}return S()(t,e),f()(t,[{key:"componentDidMount",value:function(){var e=this;this.getDeviceList(),this.listTimer=setInterval(function(){e.getDeviceList()},6e4)}},{key:"componentWillUnmount",value:function(){null!==this.listTimer&&clearInterval(this.listTimer)}},{key:"render",value:function(){var e=this,t=this.props.streamPlay.deviceList,a=this.state,u=a.playArr,m=a.isChecked,h=a.selectedValues,f=this.boundary.maxPlayerNum,v=Object(N["a"])();return x.a.createElement(I["a"],null,x.a.createElement(n["a"],{gutter:16,className:ee.a.StreamPlay},x.a.createElement(o["a"],{span:4},x.a.createElement(p["a"].Group,{value:h,className:ee.a.list},x.a.createElement(c["a"],{header:x.a.createElement("div",{className:ee.a.listHeader},"\u8bbe\u5907\u5217\u8868"),dataSource:t,renderItem:function(t){var a=t.playAddress,n=void 0===a?"":a,l=JSON.parse(n)||{},r=l.type;return x.a.createElement(c["a"].Item,{className:ee.a.listItem},x.a.createElement(p["a"],{value:t.deviceId,checked:m,disabled:!(t.onlineStatus||1===r)||u.length===f,className:ee.a.checkbox,onChange:function(a){return e.selectDevice(t,a)}}),x.a.createElement(s["a"],{title:t.onlineStatus||1===r?"\u5728\u7ebf":"\u79bb\u7ebf"},x.a.createElement(d["a"],{status:t.onlineStatus||1===r?"success":"error"})),x.a.createElement(_,{lines:1,tooltip:!0,placement:"bottomLeft"},t.deviceName))}}))),x.a.createElement(o["a"],{span:20},x.a.createElement(r["a"],{bordered:!1,bodyStyle:{padding:"8px"}},x.a.createElement(n["a"],{gutter:[8,16]},u&&u.length>0?u.map(function(t){var a=t.playAddress,n=void 0===a?"":a,l=JSON.parse(n)||{},c=l.type,s=l.urls,d=void 0===s?[]:s;return x.a.createElement(o["a"],{span:u.length>1?12:24,key:t.deviceId,style:{paddingBottom:0}},x.a.createElement(r["a"],{type:"inner",title:t.deviceName,className:ee.a.playerCard,headStyle:{minHeight:0,padding:"8px"},bodyStyle:{padding:"8px 8px 2px 8px"},extra:x.a.createElement(i["a"],{type:"close-circle",theme:"twoTone",className:ee.a.closeIcon,twoToneColor:"#f5222d",onClick:function(){return e.closePlayer(t)}})},v?0===c?x.a.createElement(T["a"],{videoUrl:"".concat(d[0].url).concat(t.deviceId),elementId:"videoEle".concat(t.deviceId)}):x.a.createElement(te["a"],{segments:d,videoType:"flv",loop:"loop",autoPlay:"autoplay"}):x.a.createElement("span",null,"\u63a8\u8350\u4f7f\u7528\u8c37\u6b4c\u6d4f\u89c8\u5668\uff0cEdge\u6d4f\u89c8\u5668\uff0cFirefox\u6d4f\u89c8\u5668")))}):x.a.createElement(r["a"],{bordered:!1,type:"inner",className:ee.a.emptyCard},x.a.createElement(l["a"],{image:l["a"].PRESENTED_IMAGE_SIMPLE,description:"\u6682\u65e0\u64ad\u653e\u6e90"})))))))}}])}(w["Component"]))||U);t["default"]=re},mcBY:function(e,t,a){e.exports={ellipsis:"antd-pro-components-ellipsis-index-ellipsis",lines:"antd-pro-components-ellipsis-index-lines",shadow:"antd-pro-components-ellipsis-index-shadow",lineClamp:"antd-pro-components-ellipsis-index-lineClamp"}}}]);